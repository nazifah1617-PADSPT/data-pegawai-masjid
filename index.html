<!doctype html>
<html lang="ms">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistem Carian Maklumat Pegawai Masjid</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
  <script src="https://unpkg.com/jspdf-autotable@latest/dist/jspdf.plugin.autotable.min.js"></script>
  <style>
        @import url('https://fonts.googleapis.com/css2?family=Aptos:wght@400;500;600;700;800;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            font-family: 'Aptos', 'Segoe UI', sans-serif;
            letter-spacing: 0.3px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.2) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .gradient-bg { 
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 25%, #0f3460 50%, #533483 75%, #7209b7 100%);
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .gradient-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
                linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.02) 50%, transparent 70%);
            animation: shimmer 8s ease-in-out infinite;
        }
        
        @keyframes shimmer {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        .card-hover { 
            position: relative;
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.1),
                0 1px 8px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
        }
        
        .card-hover::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
            border-radius: inherit;
            pointer-events: none;
        }
        
        .card-hover:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 
                0 25px 60px rgba(0, 0, 0, 0.15),
                0 5px 20px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            background: rgba(255, 255, 255, 0.98);
        }
        .search-input { 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
            position: relative;
        }
        
        .search-input:focus { 
            outline: none;
            border: 2px solid rgba(102, 126, 234, 0.6);
            box-shadow: 
                0 0 0 4px rgba(102, 126, 234, 0.1), 
                0 12px 40px rgba(102, 126, 234, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.6); 
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
        }
        
        .search-input::placeholder {
            color: rgba(107, 114, 128, 0.7);
            font-weight: 400;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            box-shadow: 
                0 10px 30px rgba(102, 126, 234, 0.4),
                0 4px 15px rgba(118, 75, 162, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            border: none;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s ease;
        }
        
        .btn-primary:hover::before {
            left: 100%;
        }
        
        .btn-primary:hover {
            box-shadow: 
                0 20px 50px rgba(102, 126, 234, 0.5),
                0 8px 25px rgba(118, 75, 162, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
            transform: translateY(-4px) scale(1.05);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #64748b 0%, #475569 50%, #334155 100%);
            box-shadow: 
                0 10px 30px rgba(100, 116, 139, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .btn-secondary:hover {
            box-shadow: 
                0 20px 50px rgba(100, 116, 139, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transform: translateY(-4px) scale(1.05);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%);
            box-shadow: 
                0 10px 30px rgba(16, 185, 129, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .btn-success:hover {
            box-shadow: 
                0 20px 50px rgba(16, 185, 129, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
            transform: translateY(-4px) scale(1.05);
        }
        
        .btn-purple {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 50%, #6d28d9 100%);
            color: white !important;
            box-shadow: 
                0 10px 30px rgba(139, 92, 246, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .btn-purple:hover {
            box-shadow: 
                0 20px 50px rgba(139, 92, 246, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
            transform: translateY(-4px) scale(1.05);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%);
            box-shadow: 
                0 10px 30px rgba(239, 68, 68, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .btn-danger:hover {
            box-shadow: 
                0 20px 50px rgba(239, 68, 68, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
            transform: translateY(-4px) scale(1.05);
        }
        .mosque-icon {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #f97316 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: iconGlow 3s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.3));
        }
        
        @keyframes iconGlow {
            0%, 100% { 
                filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.3));
                transform: scale(1);
            }
            50% { 
                filter: drop-shadow(0 0 20px rgba(251, 191, 36, 0.5));
                transform: scale(1.05);
            }
        }
        
        .fade-in {
            animation: fadeIn 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(30px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        
        .table-row {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 4px solid transparent;
        }
        
        .table-row:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(139, 92, 246, 0.05) 100%);
            border-left: 4px solid rgba(102, 126, 234, 0.4);
            transform: translateX(4px);
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.1);
        }
        
        .modal-backdrop {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(12px);
            animation: backdropFadeIn 0.3s ease;
        }
        
        @keyframes backdropFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }
        
        .floating-circle {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            animation: float 20s infinite linear;
        }
        
        .floating-circle:nth-child(1) {
            width: 80px;
            height: 80px;
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }
        
        .floating-circle:nth-child(2) {
            width: 120px;
            height: 120px;
            top: 60%;
            right: 10%;
            animation-delay: -5s;
        }
        
        .floating-circle:nth-child(3) {
            width: 60px;
            height: 60px;
            top: 80%;
            left: 20%;
            animation-delay: -10s;
        }
        
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-20px) rotate(120deg); }
            66% { transform: translateY(10px) rotate(240deg); }
            100% { transform: translateY(0px) rotate(360deg); }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
 </head>
 <body><!-- Floating Background Elements -->
  <div class="floating-elements">
   <div class="floating-circle"></div>
   <div class="floating-circle"></div>
   <div class="floating-circle"></div>
  </div><!-- Header -->
  <header class="gradient-bg text-white shadow-2xl relative z-10">
   <div class="container mx-auto px-6 py-12 relative z-10">
    <div class="flex items-center justify-between">
     <div class="flex items-center space-x-6">
      <div class="text-5xl mosque-icon relative">
       üïå 
       <div class="absolute -inset-2 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full opacity-20 blur-xl"></div>
      </div>
      <div>
       <h1 class="text-4xl font-bold bg-gradient-to-r from-white via-blue-100 to-purple-100 bg-clip-text text-transparent mb-2" style="font-family: 'Aptos', sans-serif; text-transform: uppercase; letter-spacing: 1px;">SISTEM CARIAN MAKLUMAT PEGAWAI MASJID</h1>
       <p class="text-slate-200 text-lg font-medium tracking-wide" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.5px;">‚ú® pengurusan pegawai imam, bilal &amp; siak ‚ú®</p>
       <div class="flex items-center space-x-4 mt-3"><span class="px-3 py-1 bg-white/20 rounded-full text-xs font-medium backdrop-blur-sm" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> üîç carian pantas </span> <span class="px-3 py-1 bg-white/20 rounded-full text-xs font-medium backdrop-blur-sm" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> üìä laporan pdf </span> <span class="px-3 py-1 bg-white/20 rounded-full text-xs font-medium backdrop-blur-sm" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> üì± responsif </span>
       </div>
      </div>
     </div>
     <div class="text-right bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20">
      <div class="text-sm text-slate-200 mb-1 font-medium" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">
       üìÖ tarikh
      </div>
      <p class="text-white font-semibold text-lg" id="currentDate" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"></p>
      <div class="text-sm text-slate-200 mb-1 mt-3 font-medium" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">
       ‚è∞ masa
      </div>
      <p class="text-white font-semibold text-lg" id="currentTime" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"></p>
     </div>
    </div>
   </div>
  </header><!-- Main Content -->
  <main class="container mx-auto px-6 py-12 relative z-10"><!-- Global Search -->
   <div class="mb-10">
    <div class="card-hover rounded-3xl p-8 shadow-2xl border-2 border-white/30">
     <div class="text-center mb-6">
      <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl mb-4 shadow-lg"><span class="text-3xl">üîç</span>
      </div>
      <h2 class="text-2xl font-bold text-gray-800 mb-2" style="font-family: 'Aptos', sans-serif; text-transform: uppercase; letter-spacing: 1px;">CARIAN PEGAWAI MASJID</h2>
      <p class="text-gray-600 font-medium" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">cari maklumat pegawai dengan mudah dan pantas</p>
     </div>
     <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">pilih masjid</label> <select id="filterMasjid" class="search-input w-full px-4 py-3 border border-gray-300 rounded-xl" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> <option value="">semua masjid</option> </select>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">pilih jawatan</label> <select id="filterJawatan" class="search-input w-full px-4 py-3 border border-gray-300 rounded-xl" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> <option value="">semua jawatan</option> <option value="imam">imam</option> <option value="bilal">bilal</option> <option value="siak">siak</option> </select>
      </div>
      <div class="md:col-span-1"><label class="block text-sm font-medium text-gray-700 mb-2" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">carian (nama atau no. k/p)</label> <input type="text" id="globalSearch" placeholder="üîç cari nama atau no. k/p..." class="search-input w-full px-4 py-3 border border-gray-300 rounded-xl" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">
      </div>
     </div>
     <div class="flex gap-4"><button onclick="performGlobalSearch()" class="btn-primary text-white px-6 py-3 rounded-xl font-medium" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> üîç cari </button> <button onclick="clearGlobalSearch()" class="btn-secondary text-white px-6 py-3 rounded-xl font-medium" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> üóëÔ∏è kosongkan </button>
     </div>
     <div id="globalSearchResults" class="mt-4 hidden">
      <div class="flex justify-between items-center mb-3">
       <h3 class="text-lg font-semibold text-gray-800" style="font-family: 'Aptos', sans-serif; text-transform: uppercase; letter-spacing: 0.5px;">KEPUTUSAN CARIAN:</h3><button onclick="exportSearchResultsToPDF()" id="exportSearchBtn" class="btn-purple text-white px-4 py-2 rounded-lg font-medium text-sm hidden" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> üñ®Ô∏è cetak pdf hasil carian </button>
      </div>
      <div id="searchResultsContent" class="space-y-3"></div>
     </div>
    </div>
   </div><!-- Navigation Tabs -->
   <div class="mb-12">
    <div class="flex flex-wrap gap-3 bg-white/90 backdrop-blur-lg p-3 rounded-3xl shadow-2xl border border-white/40"><button onclick="showTab('imam')" id="tab-imam" class="tab-btn btn-primary text-white px-8 py-4 rounded-2xl font-semibold transition-all text-lg" style="font-family: 'Aptos', sans-serif; text-transform: uppercase; letter-spacing: 0.5px;"> <span class="text-2xl mr-2">üïå</span> IMAM </button> <button onclick="showTab('bilal')" id="tab-bilal" class="tab-btn bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 px-8 py-4 rounded-2xl font-semibold transition-all hover:from-gray-200 hover:to-gray-300 text-lg shadow-md" style="font-family: 'Aptos', sans-serif; text-transform: uppercase; letter-spacing: 0.5px;"> <span class="text-2xl mr-2">üì¢</span> BILAL </button> <button onclick="showTab('siak')" id="tab-siak" class="tab-btn bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 px-8 py-4 rounded-2xl font-semibold transition-all hover:from-gray-200 hover:to-gray-300 text-lg shadow-md" style="font-family: 'Aptos', sans-serif; text-transform: uppercase; letter-spacing: 0.5px;"> <span class="text-2xl mr-2">üìã</span> SIAK </button> <button onclick="showTab('laporan')" id="tab-laporan" class="tab-btn bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 px-8 py-4 rounded-2xl font-semibold transition-all hover:from-gray-200 hover:to-gray-300 text-lg shadow-md" style="font-family: 'Aptos', sans-serif; text-transform: uppercase; letter-spacing: 0.5px;"> <span class="text-2xl mr-2">üìä</span> LAPORAN </button>
    </div>
   </div><!-- Imam Tab -->
   <div id="imam-tab" class="tab-content fade-in"><!-- Control Buttons -->
    <div class="mb-6 flex gap-4"><button onclick="toggleImamList()" id="toggleImamListBtn" class="btn-secondary text-white px-6 py-3 rounded-xl font-medium" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> üìã lihat senarai imam </button>
    </div>
    <div class="grid lg:grid-cols-1 gap-8"><!-- Senarai Imam -->
     <div id="imamListSection" class="lg:col-span-1 hidden">
      <div class="card-hover rounded-2xl p-6 shadow-xl">
       <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-800 flex items-center" style="font-family: 'Aptos', sans-serif; text-transform: uppercase; letter-spacing: 0.5px;"><span class="text-2xl mr-3">üïå</span> SENARAI IMAM</h2>
        <div class="flex gap-2"><button onclick="exportToPDF('imam')" class="btn-purple text-white px-4 py-2 rounded-lg font-medium text-sm" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> üñ®Ô∏è cetak pdf </button>
        </div>
       </div>
       <div class="overflow-x-auto">
        <table class="w-full">
         <thead>
          <tr class="bg-gray-50 border-b">
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">masjid</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">daerah</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">nama imam</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">no. k/p</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">pekerjaan</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">alamat</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">no. tel</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">umur</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">mula khidmat</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">catatan</th>
          </tr>
         </thead>
         <tbody id="imamList">
          <tr>
           <td colspan="10" class="text-center py-8 text-gray-500" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">
            <div class="text-4xl mb-2">
             üïå
            </div> tiada imam didaftarkan lagi</td>
          </tr>
         </tbody>
        </table>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Bilal Tab -->
   <div id="bilal-tab" class="tab-content hidden"><!-- Control Buttons -->
    <div class="mb-6 flex gap-4"><button onclick="toggleBilalList()" id="toggleBilalListBtn" class="btn-secondary text-white px-6 py-3 rounded-xl font-medium" style="text-transform: uppercase; letter-spacing: 0.5px;"> üìã LIHAT SENARAI BILAL </button>
    </div>
    <div class="grid lg:grid-cols-1 gap-8"><!-- Senarai Bilal -->
     <div id="bilalListSection" class="lg:col-span-1 hidden">
      <div class="card-hover rounded-2xl p-6 shadow-xl">
       <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-800 flex items-center" style="text-transform: uppercase; letter-spacing: 0.5px;"><span class="text-2xl mr-3">üì¢</span> SENARAI BILAL</h2>
        <div class="flex gap-2"><button onclick="exportToPDF('bilal')" class="btn-purple text-white px-4 py-2 rounded-lg font-medium text-sm" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> üñ®Ô∏è cetak pdf </button>
        </div>
       </div>
       <div class="overflow-x-auto">
        <table class="w-full">
         <thead>
          <tr class="bg-gray-50 border-b">
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="text-transform: uppercase; letter-spacing: 0.5px;">MASJID</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="text-transform: uppercase; letter-spacing: 0.5px;">DAERAH</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="text-transform: uppercase; letter-spacing: 0.5px;">NAMA BILAL</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="text-transform: uppercase; letter-spacing: 0.5px;">NO. K/P</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="text-transform: uppercase; letter-spacing: 0.5px;">PEKERJAAN</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="text-transform: uppercase; letter-spacing: 0.5px;">ALAMAT</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="text-transform: uppercase; letter-spacing: 0.5px;">NO. TEL</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="text-transform: uppercase; letter-spacing: 0.5px;">UMUR</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="text-transform: uppercase; letter-spacing: 0.5px;">MULA KHIDMAT</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700" style="text-transform: uppercase; letter-spacing: 0.5px;">CATATAN</th>
          </tr>
         </thead>
         <tbody id="bilalList">
          <tr>
           <td colspan="10" class="text-center py-8 text-gray-500">
            <div class="text-4xl mb-2">
             üì¢
            </div> Tiada bilal didaftarkan lagi</td>
          </tr>
         </tbody>
        </table>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Siak Tab -->
   <div id="siak-tab" class="tab-content hidden"><!-- Control Buttons -->
    <div class="mb-6 flex gap-4"><button onclick="toggleSiakList()" id="toggleSiakListBtn" class="btn-secondary text-white px-6 py-3 rounded-xl font-medium"> üìã Lihat Senarai Siak </button>
    </div>
    <div class="grid lg:grid-cols-1 gap-8"><!-- Senarai Siak -->
     <div id="siakListSection" class="lg:col-span-1 hidden">
      <div class="card-hover rounded-2xl p-6 shadow-xl">
       <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-800 flex items-center"><span class="text-2xl mr-3">üìã</span> Senarai Siak</h2>
        <div class="flex gap-2"><button onclick="exportToPDF('siak')" class="btn-purple text-white px-4 py-2 rounded-lg font-medium text-sm" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> üñ®Ô∏è cetak pdf </button>
        </div>
       </div>
       <div class="mb-4"><input type="text" id="searchSiak" placeholder="üîç Cari siak..." class="search-input w-full px-4 py-3 border border-gray-300 rounded-xl">
       </div>
       <div class="overflow-x-auto">
        <table class="w-full">
         <thead>
          <tr class="bg-gray-50 border-b">
           <th class="text-left py-3 px-4 font-semibold text-gray-700">Masjid</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700">Daerah</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700">Nama Siak</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700">No. K/P</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700">Pekerjaan</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700">Alamat</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700">No. Tel</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700">Umur</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700">Mula Khidmat</th>
           <th class="text-left py-3 px-4 font-semibold text-gray-700">Catatan</th>
          </tr>
         </thead>
         <tbody id="siakList">
          <tr>
           <td colspan="10" class="text-center py-8 text-gray-500">
            <div class="text-4xl mb-2">
             üìã
            </div> Tiada siak didaftarkan lagi</td>
          </tr>
         </tbody>
        </table>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Laporan Tab -->
   <div id="laporan-tab" class="tab-content hidden">
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12"><!-- Statistik Cards -->
     <div class="card-hover rounded-3xl p-8 shadow-2xl text-center border-2 border-white/30 bg-gradient-to-br from-blue-50 to-indigo-100">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-2xl mb-6 shadow-lg"><span class="text-4xl">üïå</span>
      </div>
      <h3 class="text-xl font-bold text-gray-800 mb-2" style="font-family: 'Playfair Display', serif;">Jumlah Imam</h3>
      <p class="text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent" id="totalImam">0</p>
      <div class="mt-4 text-sm text-gray-600 font-medium">
       Pegawai Imam Terdaftar
      </div>
     </div>
     <div class="card-hover rounded-3xl p-8 shadow-2xl text-center border-2 border-white/30 bg-gradient-to-br from-green-50 to-emerald-100">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-green-500 to-emerald-600 rounded-2xl mb-6 shadow-lg"><span class="text-4xl">üì¢</span>
      </div>
      <h3 class="text-xl font-bold text-gray-800 mb-2" style="font-family: 'Playfair Display', serif;">Jumlah Bilal</h3>
      <p class="text-4xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent" id="totalBilal">0</p>
      <div class="mt-4 text-sm text-gray-600 font-medium">
       Pegawai Bilal Terdaftar
      </div>
     </div>
     <div class="card-hover rounded-3xl p-8 shadow-2xl text-center border-2 border-white/30 bg-gradient-to-br from-purple-50 to-violet-100">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-purple-500 to-violet-600 rounded-2xl mb-6 shadow-lg"><span class="text-4xl">üìã</span>
      </div>
      <h3 class="text-xl font-bold text-gray-800 mb-2" style="font-family: 'Playfair Display', serif;">Jumlah Siak</h3>
      <p class="text-4xl font-bold bg-gradient-to-r from-purple-600 to-violet-600 bg-clip-text text-transparent" id="totalSiak">0</p>
      <div class="mt-4 text-sm text-gray-600 font-medium">
       Pegawai Siak Terdaftar
      </div>
     </div>
    </div><!-- Laporan Terperinci -->
    <div class="card-hover rounded-3xl p-8 shadow-2xl border-2 border-white/30">
     <div class="text-center mb-8">
      <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-orange-500 to-red-600 rounded-2xl mb-4 shadow-lg"><span class="text-3xl">üìà</span>
      </div>
      <h2 class="text-3xl font-bold text-gray-800 mb-2" style="font-family: 'Playfair Display', serif;">Laporan Terperinci</h2>
      <p class="text-gray-600 font-medium">Muat turun laporan lengkap dalam format PDF</p>
     </div>
     <div class="grid md:grid-cols-3 gap-8"><button onclick="generateReport('imam')" class="btn-primary text-white p-8 rounded-2xl text-center group hover:scale-105 transition-all duration-300">
       <div class="inline-flex items-center justify-center w-16 h-16 bg-white/20 rounded-xl mb-4 group-hover:bg-white/30 transition-all"><span class="text-4xl">üïå</span>
       </div><h3 class="font-bold text-xl mb-2" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">cetak laporan imam</h3><p class="text-sm opacity-90 font-medium" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">senarai lengkap imam masjid dengan maklumat terperinci</p></button> <button onclick="generateReport('bilal')" class="btn-success text-white p-8 rounded-2xl text-center group hover:scale-105 transition-all duration-300">
       <div class="inline-flex items-center justify-center w-16 h-16 bg-white/20 rounded-xl mb-4 group-hover:bg-white/30 transition-all"><span class="text-4xl">üì¢</span>
       </div><h3 class="font-bold text-xl mb-2" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">cetak laporan bilal</h3><p class="text-sm opacity-90 font-medium" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">senarai lengkap bilal masjid dengan maklumat terperinci</p></button> <button onclick="generateReport('siak')" class="btn-purple text-white p-8 rounded-2xl text-center group hover:scale-105 transition-all duration-300">
       <div class="inline-flex items-center justify-center w-16 h-16 bg-white/20 rounded-xl mb-4 group-hover:bg-white/30 transition-all"><span class="text-4xl">üìã</span>
       </div><h3 class="font-bold text-xl mb-2" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">cetak laporan siak</h3><p class="text-sm opacity-90 font-medium" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;">senarai lengkap siak masjid dengan maklumat terperinci</p></button>
     </div>
    </div>
   </div>
  </main><!-- Modal untuk PDF Preview -->
  <div id="pdfPreviewModal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50 p-4">
   <div class="bg-white rounded-3xl p-8 max-w-5xl w-full shadow-2xl max-h-[90vh] overflow-hidden border-2 border-white/30 backdrop-blur-xl">
    <div class="flex justify-between items-center mb-6">
     <div class="flex items-center space-x-4">
      <div class="inline-flex items-center justify-center w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl shadow-lg"><span class="text-2xl">üìÑ</span>
      </div>
      <div>
       <h3 class="text-2xl font-bold text-gray-800" id="pdfPreviewTitle" style="font-family: 'Playfair Display', serif;">Pratonton Laporan</h3>
       <p class="text-gray-600 font-medium">Semak laporan sebelum muat turun</p>
      </div>
     </div><button onclick="closePdfPreview()" class="text-gray-400 hover:text-gray-600 text-3xl font-light transition-colors hover:bg-gray-100 rounded-full w-10 h-10 flex items-center justify-center">√ó</button>
    </div>
    <div id="pdfPreviewContent" class="overflow-y-auto max-h-[60vh] mb-8 border-2 border-gray-200 rounded-2xl p-6 bg-gradient-to-br from-gray-50 to-white shadow-inner"><!-- Preview content will be inserted here -->
    </div>
    <div class="flex gap-4"><button onclick="closePdfPreview()" class="flex-1 btn-secondary text-white py-4 px-6 rounded-2xl font-semibold text-lg" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> ‚ùå tutup </button> <button onclick="confirmPdfDownload()" class="flex-1 btn-primary text-white py-4 px-6 rounded-2xl font-semibold text-lg" style="font-family: 'Aptos', sans-serif; text-transform: lowercase; letter-spacing: 0.3px;"> üñ®Ô∏è cetak pdf </button>
    </div>
   </div>
  </div>
  <script>
        // Data storage
        let imamData = [];
        let bilalData = [];
        let siakData = [];

        // Google Sheets CSV URLs
        const IMAM_SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTMdVbauPNjDdm5PjpJ9757hQAjohDd0rtXxHUfzFOZwbVovFSD6P8x41wsjfzxjw/pub?gid=1151842269&single=true&output=csv';
        const BILAL_SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ9-yKvr5cPnPV6iTD0RSRph69RGm1J7rwR6dwVaKHR0mG6Eb3wZMXeJu9O4-mgIg/pub?output=csv';
        const SIAK_SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQDy3scnQAEvhEXgi6w_zWw7AkIyh7du4EHnXJjn4BJGhHHBGY-wnR_6Ow70oDxjw/pub?gid=654609828&single=true&output=csv';

        // Function to calculate age from Malaysian IC number
        function calculateAgeFromIC(nokp) {
            if (!nokp || nokp.length < 6) return '-';
            
            try {
                const yearDigits = nokp.substring(0, 2);
                const month = nokp.substring(2, 4);
                const day = nokp.substring(4, 6);
                
                const year = parseInt(yearDigits) > 30 ? `19${yearDigits}` : `20${yearDigits}`;
                
                const birthDate = new Date(`${year}-${month}-${day}`);
                const today = new Date();
                
                let age = today.getFullYear() - birthDate.getFullYear();
                const monthDiff = today.getMonth() - birthDate.getMonth();
                
                if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                    age--;
                }
                
                return age > 0 && age < 150 ? age : '-';
            } catch (error) {
                return '-';
            }
        }

        // Function to load Imam data from Google Sheets
        async function loadImamDataFromSheet() {
            console.log('üîÑ Memuat data imam dari Google Sheets...');
            showNotification('üîÑ Sedang memuat data imam dari Google Sheets...', 'info');
            
            try {
                const response = await fetch(IMAM_SHEET_URL, {
                    method: 'GET',
                    mode: 'cors',
                    headers: {
                        'Accept': 'text/csv,text/plain,*/*'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const csvText = await response.text();
                console.log('üìÑ CSV data received:', csvText.substring(0, 200) + '...');
                
                const lines = csvText.split('\n').filter(line => line.trim());
                console.log(`üìä Found ${lines.length} lines in CSV`);
                
                imamData = [];
                
                for (let i = 1; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (line) {
                        const values = parseCSVLine(line);
                        console.log(`Row ${i}:`, values);
                        
                        if (values.length >= 8) {
                            const nokp = values[4] || '';
                            const calculatedAge = calculateAgeFromIC(nokp);
                            
                            const imam = {
                                id: Date.now() + i,
                                bil: values[0] || i,
                                masjid: values[1] || '',
                                daerah: values[2] || '',
                                nama: values[3] || '',
                                nokp: nokp,
                                pekerjaan: values[5] || '',
                                alamat: values[6] || '',
                                telefon: values[7] || '',
                                umur: values[8] || calculatedAge,
                                mulaKhidmat: values[9] || new Date().toISOString().split('T')[0],
                                catatan: values[10] || ''
                            };
                            imamData.push(imam);
                        }
                    }
                }
                
                console.log(`‚úÖ Berjaya memuat ${imamData.length} data imam`);
                displayImam();
                updateStatistics();
                updateFilterDropdowns();
                
                // Data loaded silently without notification
                
            } catch (error) {
                console.error('‚ùå Ralat memuat data imam:', error);
                showNotification(`‚ö†Ô∏è Sambungan Google Sheets gagal: ${error.message}. Sila cuba lagi.`, 'warning');
            }
        }

        // Function to load Bilal data from Google Sheets
        async function loadBilalDataFromSheet() {
            console.log('üîÑ Memuat data bilal dari Google Sheets...');
            showNotification('üîÑ Sedang memuat data bilal dari Google Sheets...', 'info');
            
            try {
                const response = await fetch(BILAL_SHEET_URL, {
                    method: 'GET',
                    mode: 'cors',
                    headers: {
                        'Accept': 'text/csv,text/plain,*/*'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const csvText = await response.text();
                console.log('üìÑ CSV data received:', csvText.substring(0, 200) + '...');
                
                const lines = csvText.split('\n').filter(line => line.trim());
                console.log(`üìä Found ${lines.length} lines in CSV`);
                
                bilalData = [];
                
                for (let i = 1; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (line) {
                        const values = parseCSVLine(line);
                        console.log(`Row ${i}:`, values);
                        
                        if (values.length >= 8) {
                            const nokp = values[4] || '';
                            const calculatedAge = calculateAgeFromIC(nokp);
                            
                            const bilal = {
                                id: Date.now() + i + 1000,
                                bil: values[0] || i,
                                masjid: values[1] || '',
                                daerah: values[2] || '',
                                nama: values[3] || '',
                                nokp: nokp,
                                pekerjaan: values[5] || '',
                                alamat: values[6] || '',
                                telefon: values[7] || '',
                                umur: values[8] || calculatedAge,
                                mulaKhidmat: values[9] || new Date().toISOString().split('T')[0],
                                catatan: values[10] || ''
                            };
                            bilalData.push(bilal);
                        }
                    }
                }
                
                console.log(`‚úÖ Berjaya memuat ${bilalData.length} data bilal`);
                displayBilal();
                updateStatistics();
                updateFilterDropdowns();
                
                // Data loaded silently without notification
                
            } catch (error) {
                console.error('‚ùå Ralat memuat data bilal:', error);
                showNotification(`‚ö†Ô∏è Sambungan Google Sheets gagal: ${error.message}. Sila cuba lagi.`, 'warning');
            }
        }

        // Function to load Siak data from Google Sheets
        async function loadSiakDataFromSheet() {
            console.log('üîÑ Memuat data siak dari Google Sheets...');
            showNotification('üîÑ Sedang memuat data siak dari Google Sheets...', 'info');
            
            try {
                const response = await fetch(SIAK_SHEET_URL, {
                    method: 'GET',
                    mode: 'cors',
                    headers: {
                        'Accept': 'text/csv,text/plain,*/*'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const csvText = await response.text();
                console.log('üìÑ CSV data received:', csvText.substring(0, 200) + '...');
                
                const lines = csvText.split('\n').filter(line => line.trim());
                console.log(`üìä Found ${lines.length} lines in CSV`);
                
                siakData = [];
                
                for (let i = 1; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (line) {
                        const values = parseCSVLine(line);
                        console.log(`Row ${i}:`, values);
                        
                        if (values.length >= 8) {
                            const nokp = values[4] || '';
                            const calculatedAge = calculateAgeFromIC(nokp);
                            
                            const siak = {
                                id: Date.now() + i + 2000,
                                bil: values[0] || i,
                                masjid: values[1] || '',
                                daerah: values[2] || '',
                                nama: values[3] || '',
                                nokp: nokp,
                                pekerjaan: values[5] || '',
                                alamat: values[6] || '',
                                telefon: values[7] || '',
                                umur: calculatedAge,
                                mulaKhidmat: values[9] || new Date().toISOString().split('T')[0],
                                catatan: values[10] || ''
                            };
                            siakData.push(siak);
                        }
                    }
                }
                
                console.log(`‚úÖ Berjaya memuat ${siakData.length} data siak`);
                displaySiak();
                updateStatistics();
                updateFilterDropdowns();
                
                // Data loaded silently without notification
                
            } catch (error) {
                console.error('‚ùå Ralat memuat data siak:', error);
                showNotification(`‚ö†Ô∏è Sambungan Google Sheets gagal: ${error.message}. Sila cuba lagi.`, 'warning');
            }
        }

        // Function to parse CSV line properly
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current.trim().replace(/"/g, ''));
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current.trim().replace(/"/g, ''));
            return result;
        }

        // Update date and time
        function updateDateTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('ms-MY', options);
            document.getElementById('currentTime').textContent = now.toLocaleTimeString('ms-MY');
        }

        // Tab functionality
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            document.getElementById(tabName + '-tab').classList.remove('hidden');
            
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('btn-primary', 'text-white');
                btn.classList.add('bg-gray-200', 'text-gray-700');
            });
            
            document.getElementById('tab-' + tabName).classList.remove('bg-gray-200', 'text-gray-700');
            document.getElementById('tab-' + tabName).classList.add('btn-primary', 'text-white');
        }
        
        // Notification function
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg text-white font-medium transform transition-all duration-300 translate-x-full`;
            
            switch(type) {
                case 'success':
                    notification.classList.add('bg-green-500');
                    break;
                case 'warning':
                    notification.classList.add('bg-yellow-500');
                    break;
                case 'error':
                    notification.classList.add('bg-red-500');
                    break;
                default:
                    notification.classList.add('bg-blue-500');
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            showTab('laporan');
            
            updateDateTime();
            setInterval(updateDateTime, 1000);
            
            // Load data automatically in background
            loadImamDataFromSheet();
            loadBilalDataFromSheet();
            loadSiakDataFromSheet();
            
            updateStatistics();
            updateFilterDropdowns();
            
            // Search functionality
            const searchSiak = document.getElementById('searchSiak');
            const globalSearch = document.getElementById('globalSearch');
            
            if (searchSiak) searchSiak.addEventListener('input', () => searchTable('siak'));
            
            if (globalSearch) {
                globalSearch.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        performGlobalSearch();
                    }
                });
            }
        });

        // Display imam (without BIL column)
        function displayImam() {
            const tbody = document.getElementById('imamList');
            
            if (imamData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="10" class="text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üïå</div>
                            Tiada imam didaftarkan lagi
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = imamData.map((imam, index) => `
                <tr class="table-row border-b hover:bg-blue-50 transition-colors">
                    <td class="py-3 px-4">${imam.masjid}</td>
                    <td class="py-3 px-4">${imam.daerah}</td>
                    <td class="py-3 px-4 font-medium">${imam.nama}</td>
                    <td class="py-3 px-4">${imam.nokp}</td>
                    <td class="py-3 px-4">${imam.pekerjaan}</td>
                    <td class="py-3 px-4">${imam.alamat}</td>
                    <td class="py-3 px-4">${imam.telefon}</td>
                    <td class="py-3 px-4">${imam.umur}</td>
                    <td class="py-3 px-4">${new Date(imam.mulaKhidmat).toLocaleDateString('ms-MY')}</td>
                    <td class="py-3 px-4">${imam.catatan || '-'}</td>
                </tr>
            `).join('');
        }

        // Display bilal (without BIL column)
        function displayBilal() {
            const tbody = document.getElementById('bilalList');
            
            if (bilalData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="10" class="text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üì¢</div>
                            Tiada bilal didaftarkan lagi
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = bilalData.map((bilal, index) => `
                <tr class="table-row border-b hover:bg-blue-50 transition-colors">
                    <td class="py-3 px-4">${bilal.masjid}</td>
                    <td class="py-3 px-4">${bilal.daerah}</td>
                    <td class="py-3 px-4 font-medium">${bilal.nama}</td>
                    <td class="py-3 px-4">${bilal.nokp}</td>
                    <td class="py-3 px-4">${bilal.pekerjaan}</td>
                    <td class="py-3 px-4">${bilal.alamat}</td>
                    <td class="py-3 px-4">${bilal.telefon}</td>
                    <td class="py-3 px-4">${bilal.umur}</td>
                    <td class="py-3 px-4">${new Date(bilal.mulaKhidmat).toLocaleDateString('ms-MY')}</td>
                    <td class="py-3 px-4">${bilal.catatan || '-'}</td>
                </tr>
            `).join('');
        }

        // Display siak (without BIL column)
        function displaySiak() {
            const tbody = document.getElementById('siakList');
            
            if (siakData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="10" class="text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìã</div>
                            Tiada siak didaftarkan lagi
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = siakData.map((siak, index) => `
                <tr class="table-row border-b hover:bg-blue-50 transition-colors">
                    <td class="py-3 px-4">${siak.masjid}</td>
                    <td class="py-3 px-4">${siak.daerah}</td>
                    <td class="py-3 px-4 font-medium">${siak.nama}</td>
                    <td class="py-3 px-4">${siak.nokp}</td>
                    <td class="py-3 px-4">${siak.pekerjaan}</td>
                    <td class="py-3 px-4">${siak.alamat}</td>
                    <td class="py-3 px-4">${siak.telefon}</td>
                    <td class="py-3 px-4">${siak.umur}</td>
                    <td class="py-3 px-4">${new Date(siak.mulaKhidmat).toLocaleDateString('ms-MY')}</td>
                    <td class="py-3 px-4">${siak.catatan || '-'}</td>
                </tr>
            `).join('');
        }

        // Update statistics
        function updateStatistics() {
            document.getElementById('totalImam').textContent = imamData.length;
            document.getElementById('totalBilal').textContent = bilalData.length;
            document.getElementById('totalSiak').textContent = siakData.length;
        }

        // Update filter dropdowns
        function updateFilterDropdowns() {
            const allData = [...imamData, ...bilalData, ...siakData];
            
            // Update Masjid filter
            const masjidSet = new Set();
            allData.forEach(item => {
                if (item.masjid) masjidSet.add(item.masjid);
            });
            
            const filterMasjid = document.getElementById('filterMasjid');
            if (filterMasjid) {
                filterMasjid.innerHTML = '<option value="">Semua Masjid</option>';
                Array.from(masjidSet).sort().forEach(masjid => {
                    filterMasjid.innerHTML += `<option value="${masjid}">${masjid}</option>`;
                });
            }
        }

        // Search functionality
        function searchTable(type) {
            const searchTerm = document.getElementById(`search${type.charAt(0).toUpperCase() + type.slice(1)}`).value.toLowerCase();
            const rows = document.querySelectorAll(`#${type}List tr`);
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        // PDF Preview and Export functionality
        let currentPdfData = null;
        let currentPdfType = '';

        function exportToPDF(type) {
            currentPdfType = type;
            showPdfPreview(type);
        }

        function showPdfPreview(type) {
            let tableData = [];
            let headers = [];
            let title = 'Senarai Pegawai Masjid';
            let kategori = '';
            let masjidList = [];
            
            if (type === 'imam') {
                kategori = 'IMAM';
                headers = ['Bil', 'Nama Imam', 'No. K/P', 'Pekerjaan', 'Alamat', 'No. Tel', 'Umur', 'Mula Khidmat'];
                tableData = imamData.map((imam, index) => [
                    index + 1,
                    imam.nama,
                    imam.nokp,
                    imam.pekerjaan,
                    imam.alamat,
                    imam.telefon,
                    imam.umur,
                    new Date(imam.mulaKhidmat).toLocaleDateString('ms-MY')
                ]);
                masjidList = [...new Set(imamData.map(imam => `${imam.masjid} (${imam.daerah})`))];
            } else if (type === 'bilal') {
                kategori = 'BILAL';
                headers = ['Bil', 'Nama Bilal', 'No. K/P', 'Pekerjaan', 'Alamat', 'No. Tel', 'Umur', 'Mula Khidmat'];
                tableData = bilalData.map((bilal, index) => [
                    index + 1,
                    bilal.nama,
                    bilal.nokp,
                    bilal.pekerjaan,
                    bilal.alamat,
                    bilal.telefon,
                    bilal.umur,
                    new Date(bilal.mulaKhidmat).toLocaleDateString('ms-MY')
                ]);
                masjidList = [...new Set(bilalData.map(bilal => `${bilal.masjid} (${bilal.daerah})`))];
            } else {
                kategori = 'SIAK';
                headers = ['Bil', 'Nama Siak', 'No. K/P', 'Pekerjaan', 'Alamat', 'No. Tel', 'Umur', 'Mula Khidmat'];
                tableData = siakData.map((siak, index) => [
                    index + 1,
                    siak.nama,
                    siak.nokp,
                    siak.pekerjaan,
                    siak.alamat,
                    siak.telefon,
                    siak.umur,
                    new Date(siak.mulaKhidmat).toLocaleDateString('ms-MY')
                ]);
                masjidList = [...new Set(siakData.map(siak => `${siak.masjid} (${siak.daerah})`))];
            }

            currentPdfData = { headers, tableData, title, type, kategori, masjidList };

            // Generate preview HTML
            const previewHtml = `
                <div class="text-center mb-6">
                    <h1 class="text-2xl font-bold mb-2">${title}</h1>
                    <h2 class="text-xl font-semibold text-blue-600 mb-3">${kategori}</h2>
                    <div class="text-left mb-4">
                        <h3 class="text-lg font-semibold mb-2">Masjid Terlibat:</h3>
                        <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                            ${masjidList.map(masjid => `<li>${masjid}</li>`).join('')}
                        </ul>
                    </div>
                    <div class="text-center text-gray-600 text-sm">
                        <p>Tarikh: ${new Date().toLocaleDateString('ms-MY')}</p>
                        <p>Jumlah Rekod: ${tableData.length}</p>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300 text-sm">
                        <thead>
                            <tr class="bg-gray-100">
                                ${headers.map(header => `<th class="border border-gray-300 px-2 py-1 text-left font-semibold">${header}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            ${tableData.map(row => `
                                <tr class="hover:bg-gray-50">
                                    ${row.map(cell => `<td class="border border-gray-300 px-2 py-1">${cell}</td>`).join('')}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;

            document.getElementById('pdfPreviewTitle').textContent = `Pratonton ${title} - ${kategori}`;
            document.getElementById('pdfPreviewContent').innerHTML = previewHtml;
            document.getElementById('pdfPreviewModal').classList.remove('hidden');
            document.getElementById('pdfPreviewModal').classList.add('flex');
        }

        function closePdfPreview() {
            document.getElementById('pdfPreviewModal').classList.add('hidden');
            document.getElementById('pdfPreviewModal').classList.remove('flex');
            currentPdfData = null;
            currentPdfType = '';
        }

        function confirmPdfDownload() {
            if (!currentPdfData) return;

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('portrait'); // Changed to portrait/vertical
            
            if (currentPdfData.type === 'hasil-carian') {
                // Header for search results
                doc.setFontSize(18);
                doc.text(currentPdfData.title, 105, 20, { align: 'center' });
                
                doc.setFontSize(16);
                doc.text(currentPdfData.kategori, 105, 35, { align: 'center' });
                
                // Masjid list
                doc.setFontSize(12);
                doc.text('Masjid Terlibat:', 20, 50);
                
                let yPosition = 60;
                currentPdfData.masjidList.forEach((masjid, index) => {
                    doc.setFontSize(10);
                    doc.text(`‚Ä¢ ${masjid}`, 25, yPosition);
                    yPosition += 8;
                });
                
                // Search info and date
                yPosition += 10;
                doc.setFontSize(10);
                doc.text(`Kata Kunci Carian: "${currentPdfData.searchTerm}"`, 20, yPosition);
                doc.text(`Tarikh: ${new Date().toLocaleDateString('ms-MY')}`, 20, yPosition + 10);
                doc.text(`Jumlah Rekod: ${currentPdfData.tableData.length}`, 20, yPosition + 20);
                
                doc.autoTable({
                    head: [currentPdfData.headers],
                    body: currentPdfData.tableData,
                    startY: yPosition + 30,
                    styles: {
                        fontSize: 8,
                        cellPadding: 2
                    },
                    headStyles: {
                        fillColor: [30, 41, 59],
                        textColor: 255,
                        fontSize: 9,
                        fontStyle: 'bold'
                    }
                });
                
                doc.save(`senarai-pegawai-hasil-carian-${currentPdfData.searchTerm.replace(/\s+/g, '-')}-${new Date().toISOString().split('T')[0]}.pdf`);
                showNotification('‚úÖ Senarai Pegawai Masjid hasil carian berjaya dicetak!', 'success');
            } else {
                // Header for regular reports
                doc.setFontSize(18);
                doc.text(currentPdfData.title, 105, 20, { align: 'center' });
                
                doc.setFontSize(16);
                doc.text(currentPdfData.kategori, 105, 35, { align: 'center' });
                
                // Masjid list
                doc.setFontSize(12);
                doc.text('Masjid Terlibat:', 20, 50);
                
                let yPosition = 60;
                currentPdfData.masjidList.forEach((masjid, index) => {
                    doc.setFontSize(10);
                    doc.text(`‚Ä¢ ${masjid}`, 25, yPosition);
                    yPosition += 8;
                });
                
                // Date and count info
                yPosition += 10;
                doc.setFontSize(10);
                doc.text(`Tarikh: ${new Date().toLocaleDateString('ms-MY')}`, 20, yPosition);
                doc.text(`Jumlah Rekod: ${currentPdfData.tableData.length}`, 20, yPosition + 10);
                
                // Table
                doc.autoTable({
                    head: [currentPdfData.headers],
                    body: currentPdfData.tableData,
                    startY: yPosition + 20,
                    styles: {
                        fontSize: 8,
                        cellPadding: 2
                    },
                    headStyles: {
                        fillColor: [30, 41, 59],
                        textColor: 255,
                        fontSize: 9,
                        fontStyle: 'bold'
                    },
                    columnStyles: {
                        0: { cellWidth: 15 }, // Bil
                        1: { cellWidth: 35 }, // Nama
                        2: { cellWidth: 30 }, // No. K/P
                        3: { cellWidth: 25 }, // Pekerjaan
                        4: { cellWidth: 40 }, // Alamat
                        5: { cellWidth: 25 }, // No. Tel
                        6: { cellWidth: 15 }, // Umur
                        7: { cellWidth: 25 }  // Mula Khidmat
                    }
                });
                
                doc.save(`senarai-pegawai-${currentPdfData.type}-${new Date().toISOString().split('T')[0]}.pdf`);
                showNotification(`‚úÖ Senarai Pegawai ${currentPdfData.kategori} berjaya dicetak!`, 'success');
            }
            
            closePdfPreview();
        }

        // Generate report
        function generateReport(type) {
            exportToPDF(type);
        }

        // Global search functionality
        let currentSearchResults = [];
        let currentSearchTerm = '';

        function performGlobalSearch() {
            const searchTerm = document.getElementById('globalSearch').value.toLowerCase().trim();
            const filterMasjid = document.getElementById('filterMasjid').value;
            const filterJawatan = document.getElementById('filterJawatan').value;
            
            const results = [];
            
            // Search in Imam data
            if (!filterJawatan || filterJawatan === 'imam') {
                imamData.forEach((imam, index) => {
                    const matchesSearch = !searchTerm || imam.nama.toLowerCase().includes(searchTerm) || imam.nokp.includes(searchTerm);
                    const matchesMasjid = !filterMasjid || imam.masjid === filterMasjid;
                    
                    if (matchesSearch && matchesMasjid) {
                        results.push({
                            type: 'Imam',
                            data: imam,
                            index: index,
                            icon: 'üïå'
                        });
                    }
                });
            }
            
            // Search in Bilal data
            if (!filterJawatan || filterJawatan === 'bilal') {
                bilalData.forEach((bilal, index) => {
                    const matchesSearch = !searchTerm || bilal.nama.toLowerCase().includes(searchTerm) || bilal.nokp.includes(searchTerm);
                    const matchesMasjid = !filterMasjid || bilal.masjid === filterMasjid;
                    
                    if (matchesSearch && matchesMasjid) {
                        results.push({
                            type: 'Bilal',
                            data: bilal,
                            index: index,
                            icon: 'üì¢'
                        });
                    }
                });
            }
            
            // Search in Siak data
            if (!filterJawatan || filterJawatan === 'siak') {
                siakData.forEach((siak, index) => {
                    const matchesSearch = !searchTerm || siak.nama.toLowerCase().includes(searchTerm) || siak.nokp.includes(searchTerm);
                    const matchesMasjid = !filterMasjid || siak.masjid === filterMasjid;
                    
                    if (matchesSearch && matchesMasjid) {
                        results.push({
                            type: 'Siak',
                            data: siak,
                            index: index,
                            icon: 'üìã'
                        });
                    }
                });
            }
            
            displayGlobalSearchResults(results, searchTerm || 'filter');
        }

        function displayGlobalSearchResults(results, searchTerm) {
            const resultsContainer = document.getElementById('globalSearchResults');
            const resultsContent = document.getElementById('searchResultsContent');
            const exportBtn = document.getElementById('exportSearchBtn');
            
            currentSearchResults = results;
            currentSearchTerm = searchTerm;
            
            if (results.length === 0) {
                resultsContent.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <div class="text-4xl mb-2">üîç</div>
                        <p>Tiada keputusan ditemui untuk carian ini</p>
                        <p class="text-sm mt-2">Cuba ubah kriteria carian anda</p>
                    </div>
                `;
                exportBtn.classList.add('hidden');
            } else {
                resultsContent.innerHTML = results.map(result => `
                    <div class="bg-white border border-gray-200 rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow">
                        <div class="flex items-start justify-between">
                            <div class="flex-1">
                                <div class="flex items-center mb-2">
                                    <span class="text-2xl mr-2">${result.icon}</span>
                                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full">${result.type}</span>
                                </div>
                                <h4 class="text-lg font-semibold text-gray-800 mb-1">${result.data.nama}</h4>
                                <div class="grid grid-cols-2 gap-4 text-sm text-gray-600">
                                    <div><strong>Masjid:</strong> ${result.data.masjid}</div>
                                    <div><strong>Daerah:</strong> ${result.data.daerah}</div>
                                    <div><strong>No. K/P:</strong> ${result.data.nokp}</div>
                                    <div><strong>Pekerjaan:</strong> ${result.data.pekerjaan}</div>
                                    <div class="col-span-2"><strong>Alamat:</strong> ${result.data.alamat}</div>
                                    <div><strong>No. Tel:</strong> ${result.data.telefon}</div>
                                    <div><strong>Umur:</strong> ${result.data.umur || '-'}</div>
                                    <div><strong>Mula Khidmat:</strong> ${new Date(result.data.mulaKhidmat).toLocaleDateString('ms-MY')}</div>
                                    <div class="col-span-2"><strong>Catatan:</strong> ${result.data.catatan || '-'}</div>
                                </div>
                            </div>
                            <div class="flex flex-col gap-2 ml-4">
                                <button onclick="goToTab('${result.type.toLowerCase()}')" class="text-green-600 hover:text-green-800 text-sm px-3 py-1 border border-green-300 rounded-lg hover:bg-green-50 transition-colors">
                                    üëÅÔ∏è Lihat
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
                exportBtn.classList.remove('hidden');
            }
            
            resultsContainer.classList.remove('hidden');
            resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Export search results to PDF with preview
        function exportSearchResultsToPDF() {
            if (currentSearchResults.length === 0) {
                showNotification('Tiada hasil carian untuk dicetak!', 'warning');
                return;
            }

            const title = 'Senarai Pegawai Masjid';
            
            // Determine category based on search results
            const categories = [...new Set(currentSearchResults.map(result => result.type.toUpperCase()))];
            const kategori = categories.length === 1 ? categories[0] : categories.join(', ');
            
            // Get unique mosques from search results
            const masjidList = [...new Set(currentSearchResults.map(result => `${result.data.masjid} (${result.data.daerah})`))];
            
            const headers = ['Bil', 'Jenis', 'Nama', 'No. K/P', 'Pekerjaan', 'Masjid', 'Daerah', 'No. Tel', 'Umur', 'Mula Khidmat'];
            const tableData = currentSearchResults.map((result, index) => [
                index + 1,
                result.type,
                result.data.nama,
                result.data.nokp,
                result.data.pekerjaan,
                result.data.masjid,
                result.data.daerah,
                result.data.telefon,
                result.data.umur || '-',
                new Date(result.data.mulaKhidmat).toLocaleDateString('ms-MY')
            ]);

            currentPdfData = { 
                headers, 
                tableData, 
                title, 
                type: 'hasil-carian',
                searchTerm: currentSearchTerm,
                kategori: kategori,
                masjidList: masjidList
            };

            // Generate preview HTML for search results
            const previewHtml = `
                <div class="text-center mb-6">
                    <h1 class="text-2xl font-bold mb-2">${title}</h1>
                    <h2 class="text-xl font-semibold text-blue-600 mb-3">${kategori}</h2>
                    <div class="text-left mb-4">
                        <h3 class="text-lg font-semibold mb-2">Masjid Terlibat:</h3>
                        <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                            ${masjidList.map(masjid => `<li>${masjid}</li>`).join('')}
                        </ul>
                    </div>
                    <div class="text-center text-gray-600 text-sm">
                        <p>Kata Kunci Carian: "${currentSearchTerm}"</p>
                        <p>Tarikh: ${new Date().toLocaleDateString('ms-MY')}</p>
                        <p>Jumlah Rekod: ${tableData.length}</p>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300 text-sm">
                        <thead>
                            <tr class="bg-gray-100">
                                ${headers.map(header => `<th class="border border-gray-300 px-2 py-1 text-left font-semibold">${header}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            ${tableData.map(row => `
                                <tr class="hover:bg-gray-50">
                                    ${row.map(cell => `<td class="border border-gray-300 px-2 py-1">${cell}</td>`).join('')}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;

            document.getElementById('pdfPreviewTitle').textContent = `Pratonton ${title} - ${kategori}`;
            document.getElementById('pdfPreviewContent').innerHTML = previewHtml;
            document.getElementById('pdfPreviewModal').classList.remove('hidden');
            document.getElementById('pdfPreviewModal').classList.add('flex');
        }
        
        function clearGlobalSearch() {
            document.getElementById('globalSearch').value = '';
            document.getElementById('filterMasjid').value = '';
            document.getElementById('filterJawatan').value = '';
            document.getElementById('globalSearchResults').classList.add('hidden');
            document.getElementById('exportSearchBtn').classList.add('hidden');
            currentSearchResults = [];
            currentSearchTerm = '';
        }
        
        function goToTab(type) {
            showTab(type);
            document.getElementById(type + '-tab').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Toggle functions for forms and lists        
        function toggleImamList() {
            const listSection = document.getElementById('imamListSection');
            const listBtn = document.getElementById('toggleImamListBtn');
            
            if (listSection.classList.contains('hidden')) {
                listSection.classList.remove('hidden');
                listBtn.classList.remove('btn-secondary');
                listBtn.classList.add('btn-primary');
                listBtn.innerHTML = '‚ùå Tutup Senarai';
            } else {
                listSection.classList.add('hidden');
                listBtn.classList.remove('btn-primary');
                listBtn.classList.add('btn-secondary');
                listBtn.innerHTML = 'üìã Lihat Senarai Imam';
            }
        }
        
        function toggleBilalList() {
            const listSection = document.getElementById('bilalListSection');
            const listBtn = document.getElementById('toggleBilalListBtn');
            
            if (listSection.classList.contains('hidden')) {
                listSection.classList.remove('hidden');
                listBtn.classList.remove('btn-secondary');
                listBtn.classList.add('btn-primary');
                listBtn.innerHTML = '‚ùå Tutup Senarai';
            } else {
                listSection.classList.add('hidden');
                listBtn.classList.remove('btn-primary');
                listBtn.classList.add('btn-secondary');
                listBtn.innerHTML = 'üìã Lihat Senarai Bilal';
            }
        }
        
        function toggleSiakList() {
            const listSection = document.getElementById('siakListSection');
            const listBtn = document.getElementById('toggleSiakListBtn');
            
            if (listSection.classList.contains('hidden')) {
                listSection.classList.remove('hidden');
                listBtn.classList.remove('btn-secondary');
                listBtn.classList.add('btn-primary');
                listBtn.innerHTML = '‚ùå Tutup Senarai';
            } else {
                listSection.classList.add('hidden');
                listBtn.classList.remove('btn-primary');
                listBtn.classList.add('btn-secondary');
                listBtn.innerHTML = 'üìã Lihat Senarai Siak';
            }
        }
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'992df22147e31be4',t:'MTc2MTE4ODAyNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>